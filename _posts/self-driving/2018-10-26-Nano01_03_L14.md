---
layout: post
title: Nano01(自動運転)-U03-Lesson14-Convolutional Neural Networks 卷积神经网络
date: 2019-01-01 02:04:04
categories: self-driving(自動運転)
tags: self-driving
---
* content
{:toc}

> 本章参考[深度学习入门-07-卷积神经网络](http://road2ai.info/2018/07/28/Deeplearning_07/)

# 6. Intuition

一个CNN会有很多层，每个层上会有不同的特征，这些层上的特征都是CNN自身学习得到的，不需要人为去指定各个层的特征。

# 7. Filters 滤波器

CNN神经网络的第一步，就是将图片分割成更小的块，这个分割的过程通过滤波器完成。

这个分割过程，在这里有详细讲解[卷积运算](http://road2ai.info/2018/07/28/Deeplearning_07/#22-%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97)

将滤波器应用在输入数据即图片上，按照步长(stride)进行移动，不断进行矩阵乘积运算，得到新的输出，一般来说增加步长会导致model的size变小，减少了一个layer上的神经元数量，最终导致精度降低。

**Filter Depth(滤波器深度)：**

一般来说滤波器不止一个，不同的滤波器应用到不同的通道上(R/G/B)，具体可以参考[3维数据的卷积运算](http://road2ai.info/2018/07/28/Deeplearning_07/#25-3%E7%BB%B4%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8D%B7%E7%A7%AF%E8%BF%90%E7%AE%97)。

# 8. Feature Map Sizes

![image](https://user-images.githubusercontent.com/18595935/52128007-2ed22b00-2677-11e9-8b0b-9f52c433402e.png)

- input depth 表示输入数据有3个通道
- output depth 表示输出数据有8个通道，说明滤波器是个四维的数据，size为(8,3,3,3)，表示意义为(FN滤波器个数，C通道，FH高，FW宽)
- Padding是**same**，表示输入数据会有填充，以保证输出数据的高宽，与输入数据一样，所以，padding为same，步幅stride是1时，三个值分别是(28,28,8)
- Padding是**valid**，表示没有填充，滤波器移动时不超过边界，根据下面的公式计算，如果步长stride为1，则结果为(26,26,8);步长为2，则结果为(13,13,8)。

![image](https://user-images.githubusercontent.com/18595935/52128885-7659b680-2679-11e9-9296-a9127bd55f64.png)

另外，多个滤波器的卷积元素，参考下图：

![image](https://user-images.githubusercontent.com/18595935/52104251-e857de80-262c-11e9-8f04-21633df17707.png)

**Same padding / valid padding:**

Same padding表示会对输入数据进行填充，使得输出数据与输入数据有相同的高和宽，而valid padding是不会填充，移动时不会超过边界。

![image](https://user-images.githubusercontent.com/18595935/52128763-2549c280-2679-11e9-8bdf-81464ea3b973.png)

# 9. Convolutions continued

![image](https://user-images.githubusercontent.com/18595935/52129338-9d64b800-267a-11e9-86df-0113c26ca548.png)

卷积层计算完毕后，需要将其变换成全连接层(Full connected layer)，然后训练分类器。

如何变换成全连接层，可以参考[基于im2col的展开](http://road2ai.info/2018/07/28/Deeplearning_07/#42-%E5%9F%BA%E4%BA%8Eim2col%E7%9A%84%E5%B1%95%E5%BC%80)

> A "Fully Connected" layer is a standard, non convolutional layer, where all inputs are connected to all output neurons. This is also referred to as a "dense" layer, and is what we used in the previous two lessons.


