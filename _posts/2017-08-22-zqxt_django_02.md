---
layout: post
title: 自强学堂-Django基础教程(2)-模板
date: 2017-08-22 22:45:59
categories: Python
tags: Django 自强学堂
---
* content
{:toc}

>无意中在网上发现了这个网站[自强学堂](http://code.ziqiangxuetang.com/django/django-tutorial.html)(作者还是校友),上面整理的教程都很不错，正好适合刚学完DjangoBasic篇之后的扩展。本系列作为该[自强学堂教程](http://code.ziqiangxuetang.com/django/django-tutorial.html)的笔记，为节省时间，与DjangoBasic部分重叠的话，会省略。

# <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>**注意：**
Django的标签导致Jekyll无法编译，都修改为了`[%`和`[{`，使用时需要替换将`[`替换为`{`！

---
# 1. Django 模板
- 按之前的步骤，新建app，并在settings.INSTALLED_APPS中加入` 'learn',`。
- 打开`learn/views.py` 写一个首页的视图

```python
def index(request):
    return render(request, 'home.html')
```

-learn目录下新建一个` templates` 文件夹，里面新建一个 `home.html`，加入如下代码。

```html
<!DOCTYPE html>
<html>
<head>
    <title>欢迎光临</title>
</head>
<body>
欢迎光临自强学堂
</body>
</html>

```

- project的url解析中添加`url(r'^$', index, name='home'),`。

- 访问`http://localhost:8000/`，能看到上面的home.html。

> 客户通过url访问 -> project的url解析 -> 对应的view -> view返回html


# 2. Django 模板-抽取通用模板 base.html的应用
网站模板的设计，一般的，我们做网站有一些通用的部分，比如 导航，底部，访问统计代码等等，我们将这三个部分抽取出来，作为通用部分.

- 在templates文件夹下新建:nav.html, bottom.html, tongji.html。
> 作为实例，在每个html中输入`<h1>☓☓☓</h1>`

- 写一个 base.html 来包含这些通用文件（include)

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>[% block title %}默认标题[% endblock%} - 自强学堂</title>
</head>
<body>
[% include 'nav.html'%}

[% block content %}
 <div> 这里是默认部分，如果不覆盖就显示这里的默认内容</div>
[% endblock %}

[% include 'bottom.html'%}
[% include 'tongji.html'%}

</body>
</html>

```

- 首页 home.html，继承或者说扩展(extends)原来的 base.html。

```html
[% extends 'base.html' %}
[% block title %} 欢迎光临首页 [% endblock %}

[% block content %}

<h1>这里是首页，欢迎光临</h1>
[% include 'ad.html' %}

[% endblock %}

```
> 上面ad.html是广告用页面，需要新建。

- 访问`http://localhost:8000/`，能看到的home.html。
![image](https://user-images.githubusercontent.com/18595935/29672334-e844a8fa-8926-11e7-9cfa-d52e3fcfa886.png)

> 注意:目前我们将模板文件，全部放在templates文件夹下面，Django会去这个文件夹中查找。但是如果如果每个app中的template都有同样的名称的html呢？这样Django就不一定能找到对应的文件了，因为Django并不能从当前app的文件夹中查找。

# 3. Django 模板查找机制
Django 模板查找机制： Django 查找模板的过程是在每个 app 的 templates 文件夹中找（而不只是当前 app 中的代码只在当前的 app 的 templates 文件夹中找）。各个 app 的 templates 形成一个文件夹列表，Django 遍历这个列表，一个个文件夹进行查找，当在某一个文件夹找到的时候就停止，所有的都遍历完了还找不到指定的模板的时候就是 Template Not Found （过程类似于Python找包）。这样设计有利当然也有弊，有利是的地方是一个app可以用另一个app的模板文件，弊是有可能会找错了。所以我们使用的时候在 templates 中建立一个 app 同名的文件夹，这样就好了。

- 把每个app中的 templates 文件夹中再建一个 app 的名称，仅和该app相关的模板放在 app/templates/app/ 目录下面。

```html
zqxt
├── tutorial
│   ├── __init__.py
│   ├── admin.py
│   ├── models.py
│   ├── templates
│   │   └── tutorial
│   │       ├── home.html
│   │       └── search.html
│   ├── tests.py
│   └── views.py
├── learn
│   ├── __init__.py
│   ├── admin.py
│   ├── models.py
│   ├── templates
│   │   └── learn
│   │       ├── home.html
│   │       └── base.html
│   │       └── ad.html
│   │       └── bottom.html
│   │       └── nav.html
│   │       └── tongji.html
│   ├── tests.py
│   └── views.py
├── manage.py
└── zqxt
    ├── __init__.py
    ├── settings.py
    ├── urls.py
    └── wsgi.py

```

- 再修改没处引用到html文件的地方，比如将`base.html`修改为`learn\base.html`，都是相对于templates目录下的路径。
这样即使html名重复，也能查找到唯一的html文件了。


# 4. 模板进阶-传递字符/列表/字典到html


# 5. 模板进阶-条件判断与for循环


# 6. 模板进阶-得到视图对应的网址

# 7. 模板进阶-逻辑操作

# 8. 模板进阶-获取当前网址和用户
