---
layout: post
title: 自强学堂-Django基础教程(3)-模型
date: 2017-08-23 22:45:59
categories: Python
tags: Django 自强学堂
---
* content
{:toc}

>无意中在网上发现了这个网站[自强学堂](http://code.ziqiangxuetang.com/django/django-tutorial.html)(作者还是校友),上面整理的教程都很不错，正好适合刚学完DjangoBasic篇之后的扩展。本系列作为该[自强学堂教程](http://code.ziqiangxuetang.com/django/django-tutorial.html)的笔记，为节省时间，与DjangoBasic部分重叠的话，会省略。

# <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>**注意：**
Django的标签导致Jekyll无法编译，都修改为了`[%`和`[{`，使用时需要替换将`[`替换为`{`！

---
> 关于模型，在DjangoBasic的 [here](https://utanesuke0612.github.io/2017/08/12/DjangoBasic_02/#7-重要动态数据) 有所涉及。

# 1. 模型操作的基本函数-新建对象

假设已经建立了一个模型Person，有name和age的field。

1. `Person.objects.create(name=name,age=age)`，创建对象时直接写入所需字段

2. 先新建对象，再保存

```python
p = Person(name="WZ", age=23)
p.save()
```

3. 新建对象，再赋值最后保存

```python
p = Person(name="TWZ")
p.age = 23
p.save()
```

4. `Person.objects.get_or_create(name="WZT", age=23)`，这种方法是防止重复很好的方法，但是速度要相对慢些，返回一个元组，第一个为Person对象，第二个为True或False, 新建时返回的是True, 已经存在时返回False.


# 2. 模型操作的基本函数-获取对象

1. `Person.objects.all()`，获取所有对象

2. `Person.objects.all()[:10] `，切片操作，获取10个人，不支持负索引，切片可以节约内存

3. `Person.objects.get(name=name)`，获取指定name的对象

4. `Person.objects.filter(name="abc") `，名称严格等于 "abc" 的人

5. `Person.objects.filter(name__exact="abc") `，名称严格等于 "abc" 的人

6. `Person.objects.filter(name__iexact="abc") `，名称为 abc 但是不区分大小写，可以找到 ABC, Abc, aBC，这些都符合条件

7. `Person.objects.filter(name__contains="abc")`，名称中包含 "abc"的人

8. `Person.objects.filter(name__icontains="abc")`，名称中包含 "abc"，且abc不区分大小写

9. `Person.objects.filter(name__regex="^abc")`，正则表达式查询

10. `Person.objects.filter(name__iregex="^abc")`，正则表达式不区分大小写

11. `Person.objects.exclude(name__contains="WZ")`， 排除包含 WZ 的Person对象

12. `Person.objects.filter(name__contains="abc").exclude(age=23)`，找出名称含有abc, 但是排除年龄是23岁的
