---
layout: post
title: 公开课-高精度地图和定位服务的实践和探讨
date: 2019-01-01 01:01:00
categories: self-driving(自動運転)
tags: self-driving Coursera
---
* content
{:toc}

下面公开课的memo：

![image](https://user-images.githubusercontent.com/18595935/53238688-4aac7800-36dd-11e9-94a9-f958cff9e64d.png)

> 本期的公开课还是不错的，值得花时间多听几遍，地址为[here](https://apposcmf8kb5033.h5.xiaoeknow.com/content_page/eyJ0eXBlIjoxMiwicmVzb3VyY2VfdHlwZSI6NCwicmVzb3VyY2VfaWQiOiJsXzVjMzg3MDc2MDg4NzZfdGRZUEtlaDAiLCJwcm9kdWN0X2lkIjoiIiwiYXBwX2lkIjoiYXBwb1NDTWY4a2I1MDMzIiwiZXh0cmFfZGF0YSI6MH0)，在weixin中收听。

贯穿课程的两个问题:
1. 为什么说高精度地图，是无人驾驶中必不可少的一部分
2. 如何解决基于高精度地图的定位服务，以及行驶过程中的function safety

无人驾驶现在面临挑战很多，最主要的问题有：
1. 驾驶过程中，是否足够安全，与人相比是否安全，否则商业上是不被信任的
2. 车辆成本，多个激光雷达，多个传感器等成本较高
只有上面两个问题(足够安全，成本可以接收)，才算是解决了自动驾驶的问题。

# 1. 从自动驾驶的需求到高精度地图的诞生

高精度地图，叫做“3D道路环境重建”更合适：
1. 传统地图：基于兴趣和点的描述，面向人和娱乐
2. 高精度地图：3维模型，基于该模型可以知道车与周围的相对距离，下一步遇到的物体高宽等信息，面向车和系统的地图，利用高精度地图，做到环境感知和相对位置定位等

高精度地图服务对象是系统，除了传统的位置信息以外，还有Z高度信息，角度信息坡度信息等。

另外，传统地图可能是每个季度一次更新，但是高精度地图是实时更新或是准实时更新，才能保证道路安全。

**两者的区别：**

![image](https://user-images.githubusercontent.com/18595935/53238912-f229aa80-36dd-11e9-859e-4ac2a03e0972.png)

技术上面临的问题：

1. 车辆上计算单元能力，尽量减少计算
2. GPS信号不稳定(城市里用GPS去定位困难太大)，受天气影响较大
3. 复杂路况(下面的换道，依赖实时计算，很难自动驾驶)

如下图中，是英国的一个环岛:

![image](https://user-images.githubusercontent.com/18595935/53238840-c4dcfc80-36dd-11e9-83bd-fbde5341442a.png)

**高精地图产业面临的问题：**

![image](https://user-images.githubusercontent.com/18595935/53239252-eb4f6780-36de-11e9-9fc8-da9b5dca62ea.png)

- 成本，通过人工智能处理的方式，降低内业处理成本。
- 规模，需要达到规模化生成。能否批量化采集，生产，以及更新，是判断规模的标准。

**高精度地图组成：**

- 点云图：使用激光雷达，对现实世界的三维建模。不仅能获得物体XYZ的信息，还能获得车辆与物体的相对位置信息。通过这个相对位置信息，可以做定位服务，以及在做路径规划的时候，规划一条安全的路径。
- Landmark矢量地图，基于点云图作成的道路相关信息地图，是道路规划时重要的底层信息。
- 其他增值服务，现在更多的是定位服务，相对精度的定位服务。

![image](https://user-images.githubusercontent.com/18595935/53239403-497c4a80-36df-11e9-85a0-7dd1e4a08066.png)

![image](https://user-images.githubusercontent.com/18595935/53239531-9e1fc580-36df-11e9-95f8-516d927f9797.png)

# 2. 适用于高级自动驾驶的高精度地图的关键特性

通过这些关键特性来定义高精度地图，什么才是合适的高精度地图产品。

1. 点云图
2. 矢量图，基于点云图生成，作成道路的车道线，交通标识，指示牌(也可以内容读取，比如限速等)等
3. 定位服务

为什么需要一个地图引擎? 高精度的生产并不是基于人工制图的过程，而是一种自动化建图过程。

1. 计算力，基于公共云进行海量数据的存储和计算
2. 网络环境，wifi/5G，比如通过充电桩进行数据加载

下面是一个地图引擎的处理过程：

![image](https://user-images.githubusercontent.com/18595935/53239755-2aca8380-36e0-11e9-91c6-4b85849fdace.png)

**地图更新：**

数据融合 -> 特征检测 -> 训练模型 -> 自动处理收集数据 -> 基于处理后数据形成矢量图 -> 最后人工check

![image](https://user-images.githubusercontent.com/18595935/53239789-46358e80-36e0-11e9-9e5b-350744c27a3b.png)

# 3. 高精度地图的评价体系和实际价值探讨

**如何评价点云地图：**

1. 精度，传统地图是基于基准点看偏离位置，而高精度地图更多是相对精度(3D点云图与实时物体位置的偏离)，要达到5cm级别(车道线大部分10cm宽度)，只有达到5cm了才能实现车辆行驶的平稳无漂移。
2. 正确性，除了固定的建筑物等以外，还有一些人为障碍物(短暂停车等)，这种需要去除掉。
3. 点云属性
4. 存储方式，压缩比率等都是比较关键的点
5. 元素完备性

![image](https://user-images.githubusercontent.com/18595935/53240564-5cdce500-36e2-11e9-89f4-564417f9b61c.png)

**元素完备性：**

![image](https://user-images.githubusercontent.com/18595935/53240413-fce63e80-36e1-11e9-908f-ad546ff24f84.png)

# 4. 实例讲解基于高精度地图的定位服务

![image](https://user-images.githubusercontent.com/18595935/53240962-7e8a9c00-36e3-11e9-8f5e-bffe8080e4ec.png)

![image](https://user-images.githubusercontent.com/18595935/53240969-877b6d80-36e3-11e9-9a96-4370e3e25910.png)

![image](https://user-images.githubusercontent.com/18595935/53240977-8f3b1200-36e3-11e9-8784-ebd5ed8298e3.png)

当某一些传感器失效的时候，地图能够工作，所以依赖于高精度地图的无人驾驶更有鲁棒性，更安全。

# 5. QA环节

- 高精度建立的难点：
> 1. 数据量大 2. 精度高 3. 实时性(更新) 
> 其他更具体的难点：4. 多数据融合(正向扫描与反向扫描时保证同一物体一致性) 5. 自动化提取关键特征 6. 如何满足规模化制图

- 不同场景上的高精度地图要求：
> 高速路/园区路等，对高精度地图的要求不同，另外测量的方式也有不同

- 当前还没有一个行业标准的高精度地图格式

- 矢量图没有绝对坐标系，只有相对坐标。

- 停车场地图，停车场内GPS无信号，Deepmap可以提供停车场地图。

- 众包数据污染，车辆启动的时候，会首先启动校准定位，如果定位OK才开始。

- 地图评估有自动化工具，但最后还是人工check。(比如，去除军事禁区的地图)

