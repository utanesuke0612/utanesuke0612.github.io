---
layout: post
title: AWS：ゼロから実践するAmazon Web Services
date: 2020-05-11 01:00:00
categories: 虚拟化(网络/存储/Cloud)
tags: 其他
---
* content
{:toc}

> 最近想自己通过python/Django构建一个web服务，其中涉及到infra，考虑过idcf，因为以前用过比较熟悉，但是主流是AWS，以后很多服务都是构建于AWS的，需要掌握AWS的基本用法。
> 
> 这是一个Udemy的课程，参考[AWS：ゼロから実践するAmazon Web Services](https://www.udemy.com/course/aws-and-infra/)
> 

# 1. 使用AWS构建网络和服务器

懂Infra对现在的系统构建很有用处：
1. 可以创建自己的web服务
2. 从系统整体上进行考虑(发生问题时能够切分,考虑对策时不仅能从App层考虑，还能从系统整体去考虑)

构建Infra的时候，网络和服务器通过下面的方式进行构建：
- **服务器构成**
1. 需要什么样的服务器
2. 设置服务器
3. 在服务器上安装OS，进行各种设定
4. 安装需要的软件，并进行设定

- **网络构成**，将构建的服务器连接到网络：
1. 决定网络使用的IP范围
2. 给服务器分配IP地址
3. 给各个IP地址分配域名

下面比较一下オンプレミス和クラウド，日本很多公司喜欢自己构建
服务器，敏感数据是不会放到云上去的。
- **オンプレミス**
1. 自己准备硬件软件，自己进行管理
2. 优点是自由度高
3. 缺点是初期cost高，需要时间，很难对服务器进行增减

- **クラウド**
1. infra通过网络进行管理和使用
2. 优点是，初期cost少，能马上使用，服务器的增减也比较自由
3. 缺点是，费用的预测困难，另外，cloud整体发生故障的话，自己无法对应

# 2. AWS的初期设定

主要完成：

- 注册账号(使用的 lijun.206@gmail.com 账号)
- 使用CloudWatch进行金额监视
- IAM用户的作成(作业用user)
- 使用CloudTrail记录操作log

## 2.1 注册账号

略过，可以有一年的免费试用期间。

## 2.2 金额监视

通过下面的两种方式进行设定:

1. [Billing の設定](https://console.aws.amazon.com/billing/home?#/preferences)
2. [CloudWatch](https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#alarmsV2:)

## 2.3 IAM用户

在AWS的BestPractice中，极力推荐不要使用root user，作业的时候使用IAM user：

- **root user:**
1. 该用户有所有权限
2. 只在账户的解约等时候使用
3. 极力推荐不要使用root user

- **IAM user：**
1. 在AWS内做成的user
2. 可以修改认证信息和访问许可
3. 可以分用户作成
4. 一般的作业使用IAM user

- [设置页面](https://console.aws.amazon.com/iam/home?#/home)
- [LOGIN 用： console](https://336452230265.signin.aws.amazon.com/console)
> 用户名  junli_work


## 2.4 使用CloudTrail记录操作log

- **CloudTrail：**
1. 记录AWS用户操作记录
2. 默认是有效的，保存90天
3. 可以保存到S3，永久保存
4. CloudTrail是免费的，但是S3是收费的

在这里作成：[CloudTrail](https://console.aws.amazon.com/cloudtrail/home?region=us-east-1#/dashboard)

以后log保存在S3这里：[AWSLogs](https://console.aws.amazon.com/s3/buckets/aws-and-infra-junli/AWSLogs/336452230265/CloudTrail/?region=us-east-1#)

# 3. VPC-网络构建

本章包含：
- AWS中的网络
- 决定网络中的IP地址
- 作成VPC
- 作成subnet
- 设置routing
- 网络设计时需要顾虑的方面

本次的例子的网络构成如下：

![image](https://user-images.githubusercontent.com/18595935/81632433-3ae59480-9445-11ea-98ea-b5a43e42d72f.png)


# 4. EC2-web服务器构建

# 5. Route53-域名登录

# 6. RDS-DB服务器构建

# 7. EC2-WordPress构建

# 8. S3-CloudFront-分发图片

# 9. ELB-Web层的冗长化

# 10. RDS-DB层的冗长化

# 11. IAM-访问权限管理

# 12. 其他
